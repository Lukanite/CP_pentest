# Project 8 - Pentesting Live Targets

Time spent: **X** hours spent in total

> Objective: Identify vulnerabilities in three different versions of the Globitek website: blue, green, and red.

The six possible exploits are:
* Username Enumeration
* Insecure Direct Object Reference (IDOR)
* SQL Injection (SQLi)
* Cross-Site Scripting (XSS)
* Cross-Site Request Forgery (CSRF)
* Session Hijacking/Fixation

Each version of the site has been given two of the six vulnerabilities. (In other words, all six of the exploits should be assignable to one of the sites.)

## All (Bonus!)

Reflected XSS?! Yep... More specifically, authenticated reflected XSS.

## Blue

Vulnerability #1: SQL Injection

The "Show" function for listing Salespeople details does not perform sufficient validation on `id` (i.e. check to see if it's an integer), allowing SQL injection to occur.

Vulnerability #2: Session Hijacking/Fixation

This website expires cookies after 1 year, which provides ample opportunity for attackers to hijack an old user session.

## Green

Vulnerability #1: Username Enumeration

A failed login with a valid username results in this failed message:
`
<span class="failure">Log in was unsuccessful.</span>
`
However, a failed login with a non-existent username results in this failed message (with a different span class):
`
<span class="failed">Log in was unsuccessful.</span>
`
Based on these differences, an attacker can determine whether or not a given username exists.

Vulnerability #2: Stored XSS

The feedback form on this website does not properly strip javascript from both the name and feedback fields, allowing XSS to spring upon an unsuspecting admin.

Example POC:
`
<a href=a onmouseover='alert("Lucario is better than Mewtwo")'>Super Smash Bros True Facts</a>
`

## Red

Vulnerability #1: Insecure Direct Object Reference

By changing the `id` GET parameter, you can obtain information about salespeople who are "not public" yet. 

Vulnerability #2: Cross-Site Request Forgery

All websites actually have a hidden post variable called `csrf_token`, but the Red site doesn't check this; you can change it to anything and it'll accept the update, making it vulnerable to CSRF.


## Notes

Describe any challenges encountered while doing the work

