# Project 8 - Pentesting Live Targets

Time spent: **3** hours spent in total

> Objective: Identify vulnerabilities in three different versions of the Globitek website: blue, green, and red.

The six possible exploits are:
* Username Enumeration
* Insecure Direct Object Reference (IDOR)
* SQL Injection (SQLi)
* Cross-Site Scripting (XSS)
* Cross-Site Request Forgery (CSRF)
* Session Hijacking/Fixation

Each version of the site has been given two of the six vulnerabilities. (In other words, all six of the exploits should be assignable to one of the sites.)

## All (Bonus!)

Reflected XSS?! Yep... More specifically, authenticated reflected XSS.

## Blue

Vulnerability #1: SQL Injection

The "Show" function for listing Salespeople details does not perform sufficient validation on `id` (i.e. check to see if it's an integer), allowing SQL injection to occur.

POC:

Break the page by putting in a single quote for ID, or plug your own search terms into the page:
```
' OR id='2
```

GIF (124KB, ~13s):

<img src="https://github.com/Lukanite/CP_pentest/raw/master/3.gif" />

Vulnerability #2: Session Hijacking/Fixation

This website expires cookies after 1 year, which provides ample opportunity for attackers to hijack an old user session.

GIF (43KB, static):

<img src="https://github.com/Lukanite/CP_pentest/raw/master/6.gif" />

## Green

Vulnerability #1: Username Enumeration

A failed login with a valid username results in this failed message:
```html
<span class="failure">Log in was unsuccessful.</span>
```
However, a failed login with a non-existent username results in this failed message (with a different span class):
```html
<span class="failed">Log in was unsuccessful.</span>
```
Based on these differences, an attacker can determine whether or not a given username exists.

GIF (427KB, ~17s):

<img src="https://github.com/Lukanite/CP_pentest/raw/master/1.gif" />

Vulnerability #2: Stored XSS

The feedback form on this website does not properly strip javascript from both the name and feedback fields, allowing XSS to spring upon an unsuspecting admin.

Example POC:
```html
<a href=a onmouseover='alert("Lucario is better than Mewtwo")'>Super Smash Bros True Facts</a>
```

GIF (265KB, ~9s):

<img src="https://github.com/Lukanite/CP_pentest/raw/master/4.gif" />

## Red

Vulnerability #1: Insecure Direct Object Reference

By changing the `id` GET parameter, you can obtain information about salespeople who are "not public" yet. 

Vulnerability #2: Cross-Site Request Forgery

All websites actually have a hidden post variable called `csrf_token`, but the Red site doesn't check this; you can change it to anything and it'll accept the update, making it vulnerable to CSRF.


## Notes

Describe any challenges encountered while doing the work

